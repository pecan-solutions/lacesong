<UserControl x:Class="Lacesong.WPF.Views.BepInExInstallView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.openxmlformats.org/expression/blend/2008" 
             xmlns:vm="clr-namespace:Lacesong.WPF.ViewModels"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="800"
             d:DataContext="{d:DesignInstance vm:BepInExInstallViewModel}">


    <Grid Margin="32">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,24">
            <TextBlock Text="Mod Loader Installation" FontSize="24" FontWeight="SemiBold" 
                       Foreground="{DynamicResource PrimaryTextBrush}" Margin="0,0,0,8"/>
            <TextBlock Text="Install or manage BepInEx mod loader for your game." 
                       FontSize="14" Foreground="{DynamicResource SecondaryTextBrush}" TextWrapping="Wrap"/>
        </StackPanel>

        <!-- Main Content -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="20"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Status Panel -->
            <Border Grid.Column="0" Background="{DynamicResource CardBrush}" 
                    CornerRadius="6" Padding="24" Margin="0,0,8,0">
                <StackPanel>
                    <TextBlock Text="Installation Status" FontSize="18" FontWeight="SemiBold" 
                               Foreground="{DynamicResource PrimaryTextBrush}" Margin="0,0,0,16"/>
                    
                    <TextBlock Text="{Binding InstallationStatus}" FontSize="14" 
                               Foreground="{DynamicResource SecondaryTextBrush}" 
                               TextWrapping="Wrap" Margin="0,0,0,16"/>
                    
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                        <Ellipse Width="10" Height="10" Fill="{DynamicResource SuccessBrush}" 
                                 Margin="0,0,8,0" Visibility="{Binding IsBepInExInstalled, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                        <Ellipse Width="10" Height="10" Fill="{DynamicResource WarningBrush}" 
                                 Margin="0,0,8,0" Visibility="{Binding IsBepInExInstalled, Converter={StaticResource InverseBooleanToVisibilityConverter}}"/>
                        <TextBlock Text="{Binding IsBepInExInstalled, Converter={StaticResource BepInExStatusConverter}}" 
                                   FontSize="13" Foreground="{DynamicResource PrimaryTextBrush}"/>
                    </StackPanel>
                    
                    <Button Content="Refresh Status" Command="{Binding RefreshStatusCommand}" 
                            Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,0,16"/>
                    
                    <TextBlock Text="BepInEx is a Unity mod loader that allows you to install and manage mods for Unity-based games like Hollow Knight: Silksong." 
                               FontSize="11" Foreground="{DynamicResource SecondaryTextBrush}" 
                               TextWrapping="Wrap"/>
                </StackPanel>
            </Border>

            <!-- Installation Panel -->
            <Border Grid.Column="2" Background="{DynamicResource CardBrush}" 
                    CornerRadius="6" Padding="24" Margin="8,0,0,0">
                <StackPanel>
                    <TextBlock Text="Installation Options" FontSize="18" FontWeight="SemiBold" 
                               Foreground="{DynamicResource PrimaryTextBrush}" Margin="0,0,0,16"/>
                    
                    <!-- Version Selection -->
                    <TextBlock Text="BepInEx Version:" FontSize="13" FontWeight="SemiBold" 
                               Foreground="{DynamicResource PrimaryTextBrush}" Margin="0,0,0,8"/>
                    <ComboBox ItemsSource="{Binding AvailableVersions}" 
                              SelectedItem="{Binding SelectedVersion}"
                              Style="{DynamicResource ComboBoxStyle}" Margin="0,0,0,16"/>
                    
                    <!-- Options -->
                    <CheckBox Content="Force reinstall (if already installed)" 
                              IsChecked="{Binding ForceReinstall}"
                              Style="{DynamicResource CheckBoxStyle}" Margin="0,0,0,8"/>
                    
                    <CheckBox Content="Create backup before installation" 
                              IsChecked="{Binding CreateBackup}"
                              Style="{DynamicResource CheckBoxStyle}" Margin="0,0,0,8"/>
                    
                    <CheckBox Content="Create desktop shortcut" 
                              IsChecked="{Binding CreateDesktopShortcut}"
                              Style="{DynamicResource CheckBoxStyle}" Margin="0,0,0,16"/>
                    
                    <!-- Action Buttons -->
                    <Button Content="Install BepInEx" Command="{Binding InstallBepInExCommand}" 
                            Style="{DynamicResource PrimaryButtonStyle}" 
                            IsEnabled="{Binding CanInstall}" Margin="0,0,0,8"/>
                    
                    <Button Content="Uninstall BepInEx" Command="{Binding UninstallBepInExCommand}" 
                            Style="{DynamicResource DangerButtonStyle}" 
                            IsEnabled="{Binding CanUninstall}"/>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Progress/Status -->
        <Border Grid.Row="2" Background="{DynamicResource CardBrush}" 
                CornerRadius="6" Padding="24" Margin="0,16,0,0" 
                Visibility="{Binding IsBusy, Converter={StaticResource BooleanToVisibilityConverter}}">
            <StackPanel>
                <TextBlock Text="Installation Progress" FontSize="14" FontWeight="SemiBold" 
                           Foreground="{DynamicResource PrimaryTextBrush}" Margin="0,0,0,8"/>
                
                <ProgressBar IsIndeterminate="True" Height="6" 
                             Background="{DynamicResource ProgressBackgroundBrush}"
                             Foreground="{DynamicResource PrimaryBrush}"/>
                
                <TextBlock Text="{Binding StatusMessage}" FontSize="12" 
                           Foreground="{DynamicResource SecondaryTextBrush}" 
                           Margin="0,8,0,0" TextWrapping="Wrap"/>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
