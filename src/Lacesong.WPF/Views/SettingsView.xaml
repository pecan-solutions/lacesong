<ui:UiPage x:Class="Lacesong.WPF.Views.SettingsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.openxmlformats.org/expression/blend/2008" 
             xmlns:vm="clr-namespace:Lacesong.WPF.ViewModels"
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="800"
             d:DataContext="{d:DesignInstance vm:SettingsViewModel}">


    <Grid Margin="42">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,24">
            <TextBlock Text="Settings" Style="{StaticResource TitleTextBlockStyle}" Margin="0,0,0,8"/>
            <TextBlock Text="Configure Lacesong to fit your modding workflow." 
                       Style="{StaticResource SubtitleTextBlockStyle}"/>
        </StackPanel>

        <!-- Settings Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <StackPanel>
                <!-- General Settings -->
                <ui:Card Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="General" Style="{StaticResource SectionHeaderTextBlockStyle}" Margin="0,0,0,20"/>
                        
                        <ui:CheckBox Content="Automatically check for updates on startup" 
                                     IsChecked="{Binding AutoCheckForUpdates}"
                                     Margin="0,0,0,12"/>
                        
                        <ui:CheckBox Content="Create backups before installing mods" 
                                     IsChecked="{Binding CreateBackupsBeforeInstall}"
                                     Margin="0,0,0,12"/>
                        
                        <ui:CheckBox Content="Show advanced options" 
                                     IsChecked="{Binding ShowAdvancedOptions}"
                                     Margin="0,0,0,12"/>
                        
                        <ui:CheckBox Content="Enable telemetry (helps us improve Lacesong)" 
                                     IsChecked="{Binding EnableTelemetry}"/>
                    </StackPanel>
                </ui:Card>

                <!-- BepInEx Settings -->
                <ui:Card Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="BepInEx" Style="{StaticResource SectionHeaderTextBlockStyle}" Margin="0,0,0,20"/>
                        
                        <TextBlock Text="Default BepInEx Version" Style="{StaticResource BodyStrongTextBlockStyle}" Margin="0,0,0,8"/>
                        
                        <ui:ComboBox ItemsSource="{Binding BepInExVersions}" 
                                     SelectedItem="{Binding BepInExVersion}"
                                     Width="240" HorizontalAlignment="Left"/>
                    </StackPanel>
                </ui:Card>

                <!-- Logging Settings -->
                <ui:Card Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="Logging" Style="{StaticResource SectionHeaderTextBlockStyle}" Margin="0,0,0,20"/>
                        
                        <TextBlock Text="Log Level" Style="{StaticResource BodyStrongTextBlockStyle}" Margin="0,0,0,8"/>
                        
                        <ui:ComboBox ItemsSource="{Binding LogLevels}" 
                                     SelectedItem="{Binding LogLevel}"
                                     Width="240" HorizontalAlignment="Left" 
                                     Margin="0,0,0,20"/>
                        
                        <StackPanel Orientation="Horizontal">
                            <ui:Button Content="Open Logs Folder" Command="{Binding OpenLogsFolderCommand}" 
                                       Appearance="Secondary" Icon="Folder24" Margin="0,0,8,0"/>
                            
                            <ui:Button Content="Clear Logs" Command="{Binding ClearLogsCommand}" 
                                       Appearance="Secondary" Icon="Delete24"/>
                        </StackPanel>
                    </StackPanel>
                </ui:Card>

                <!-- Update Settings -->
                <ui:Card Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="Updates" Style="{StaticResource SectionHeaderTextBlockStyle}" Margin="0,0,0,20"/>
                        
                        <ui:Button Content="Check for Updates" Command="{Binding CheckForUpdatesCommand}" 
                                   Appearance="Primary" Icon="ArrowClockwise24" Margin="0,0,0,12"/>
                        
                        <TextBlock Text="Last checked: Never" Style="{StaticResource SmallFadedTextBlockStyle}"/>
                    </StackPanel>
                </ui:Card>

                <!-- Import/Export Settings -->
                <ui:Card Padding="24" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="Settings Management" Style="{StaticResource SectionHeaderTextBlockStyle}" Margin="0,0,0,20"/>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <ui:Button Content="Export Settings" Command="{Binding ExportSettingsCommand}" 
                                       Appearance="Secondary" Icon="ArrowUpload24" Margin="0,0,8,0"/>
                            
                            <ui:Button Content="Import Settings" Command="{Binding ImportSettingsCommand}" 
                                       Appearance="Secondary" Icon="ArrowDownload24"/>
                        </StackPanel>
                        
                        <ui:Button Content="Reset to Defaults" Command="{Binding ResetToDefaultsCommand}" 
                                   Appearance="Secondary" Icon="ArrowSync24"/>
                    </StackPanel>
                </ui:Card>
            </StackPanel>
        </ScrollViewer>

        <!-- Action Buttons -->
        <ui:Card Grid.Row="2" Padding="16" Margin="0,16,0,0">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <ui:Button Content="Reset" Command="{Binding ResetToDefaultsCommand}" 
                           Appearance="Secondary" Margin="0,0,8,0"/>
                
                <ui:Button Content="Save Settings" Command="{Binding SaveSettingsCommand}" 
                           Appearance="Primary"/>
            </StackPanel>
        </ui:Card>
    </Grid>
</ui:UiPage>
