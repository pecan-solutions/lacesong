<UserControl x:Class="Lacesong.WPF.Views.SettingsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:vm="clr-namespace:Lacesong.WPF.ViewModels"
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="800"
             d:DataContext="{d:DesignInstance vm:SettingsViewModel}">


    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,24">
            <TextBlock Text="Settings" Style="{StaticResource TitleTextBlockStyle}" Margin="0,0,0,8"/>
            <TextBlock Text="Configure Lacesong to fit your modding workflow." 
                       Style="{StaticResource SubtitleTextBlockStyle}"/>
        </StackPanel>

        <!-- Settings Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <StackPanel>
                <!-- General Settings -->
                <Border Style="{StaticResource CardBorderStyle}" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="General" Style="{StaticResource SectionHeaderTextBlockStyle}" Margin="0,0,0,20"/>
                        
                        <CheckBox Style="{StaticResource DefaultCheckBoxStyle}" Content="Automatically check for updates on startup" 
                                     IsChecked="{Binding AutoCheckForUpdates}"
                                     Margin="0,0,0,12"/>
                        
                        <CheckBox Style="{StaticResource DefaultCheckBoxStyle}" Content="Create backups before installing mods" 
                                     IsChecked="{Binding CreateBackupsBeforeInstall}"
                                     Margin="0,0,0,12"/>
                        
                        <CheckBox Style="{StaticResource DefaultCheckBoxStyle}" Content="Show advanced options" 
                                     IsChecked="{Binding ShowAdvancedOptions}"
                                     Margin="0,0,0,12"/>
                        
                        <CheckBox Style="{StaticResource DefaultCheckBoxStyle}" Content="Enable telemetry (helps us improve Lacesong)" 
                                     IsChecked="{Binding EnableTelemetry}"/>
                    </StackPanel>
                </Border>

                <!-- BepInEx Settings -->
                <Border Style="{StaticResource CardBorderStyle}" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="BepInEx" Style="{StaticResource SectionHeaderTextBlockStyle}" Margin="0,0,0,20"/>
                        
                        <TextBlock Text="Default BepInEx Version" Style="{StaticResource BodyStrongTextBlockStyle}" Margin="0,0,0,8"/>
                        
                        <ComboBox Style="{StaticResource DefaultComboBoxStyle}" ItemsSource="{Binding BepInExVersions}" 
                                     SelectedItem="{Binding BepInExVersion}"
                                     Width="240" HorizontalAlignment="Left"/>
                    </StackPanel>
                </Border>

                <!-- Logging Settings -->
                <Border Style="{StaticResource CardBorderStyle}" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="Logging" Style="{StaticResource SectionHeaderTextBlockStyle}" Margin="0,0,0,20"/>
                        
                        <TextBlock Text="Log Level" Style="{StaticResource BodyStrongTextBlockStyle}" Margin="0,0,0,8"/>
                        
                        <ComboBox Style="{StaticResource DefaultComboBoxStyle}" ItemsSource="{Binding LogLevels}" 
                                     SelectedItem="{Binding LogLevel}"
                                     Width="240" HorizontalAlignment="Left" 
                                     Margin="0,0,0,20"/>
                        
                        <StackPanel Orientation="Horizontal">
                            <Button Style="{StaticResource SecondaryButtonStyle}" Content="Open Logs Folder" Command="{Binding OpenLogsFolderCommand}" Margin="0,0,8,0"/>
                            <Button Style="{StaticResource SecondaryButtonStyle}" Content="Clear Logs" Command="{Binding ClearLogsCommand}"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Update Settings -->
                <Border Style="{StaticResource CardBorderStyle}" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="Updates" Style="{StaticResource SectionHeaderTextBlockStyle}" Margin="0,0,0,20"/>
                        
                        <Button Style="{StaticResource PrimaryButtonStyle}" Content="Check for Updates" Command="{Binding CheckForUpdatesCommand}" Margin="0,0,0,12"/>
                        
                        <TextBlock Text="Last checked: Never" Style="{StaticResource SmallFadedTextBlockStyle}"/>
                    </StackPanel>
                </Border>

                <!-- Import/Export Settings -->
                <Border Style="{StaticResource CardBorderStyle}" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="Settings Management" Style="{StaticResource SectionHeaderTextBlockStyle}" Margin="0,0,0,20"/>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <Button Style="{StaticResource SecondaryButtonStyle}" Content="Export Settings" Command="{Binding ExportSettingsCommand}" Margin="0,0,8,0"/>
                            <Button Style="{StaticResource SecondaryButtonStyle}" Content="Import Settings" Command="{Binding ImportSettingsCommand}" />
                        </StackPanel>
                        
                        <Button Style="{StaticResource SecondaryButtonStyle}" Content="Reset to Defaults" Command="{Binding ResetToDefaultsCommand}" />
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <!-- Action Buttons -->
        <Border Grid.Row="2" Style="{StaticResource CardBorderStyle}" Padding="16" Margin="0,16,0,0">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Style="{StaticResource SecondaryButtonStyle}" Content="Reset" Command="{Binding ResetToDefaultsCommand}" Margin="0,0,8,0"/>
                <Button Style="{StaticResource PrimaryButtonStyle}" Content="Save Settings" Command="{Binding SaveSettingsCommand}" />
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
